#==========================================================================================================================
# THIS SCRIPT FORCES THE MACHINE POLICY TO CHECK SCCM AND UPDATE APPLICATIONS ON A REMOTE COMPUTER LOCATED ON THE
# "SAME" DOMAIN AS THE ADMIN COMPUTER.
#==========================================================================================================================

$REMOTEMACHINE = READ-HOST "ENTER THE COMPUTERNAME OF THE REMOTE COMPUTER"
$TRIGGER = (`
"{00000000-0000-0000-0000-000000000021}",`
"{00000000-0000-0000-0000-000000000002}",`
"{00000000-0000-0000-0000-000000000103}",`
"{00000000-0000-0000-0000-000000000104}",`
"{00000000-0000-0000-0000-000000000001}",`
"{00000000-0000-0000-0000-000000000102}",`
"{00000000-0000-0000-0000-000000000031}",`
"{00000000-0000-0000-0000-000000000108}",`
"{00000000-0000-0000-0000-000000000041}",`
"{00000000-0000-0000-0000-000000000106}",`
"{00000000-0000-0000-0000-000000000107}")
INVOKE-WMIMETHOD -COMPUTERNAME $REMOTEMACHINE -NAMESPACE ROOT\CCM -CLASS SMS_CLIENT -NAME TRIGGERSCHEDULE $TRIGGER

#==========================================================================================================================
# ALTERNATIVELY YOU CAN USE THE FOLLOWING CODE TO FORCE THE MACHINE POLICY
# ON MULTIPLE COMPUTERS LISTED IN A TEXT FILE
#==========================================================================================================================

# $REMOTEMACHINE = READ-HOST "ENTER THE COMPUTERNAME OF THE REMOTE COMPUTER"
# $TRIGGER=("{00000000-0000-0000-0000-000000000021}",`
#"{00000000-0000-0000-0000-000000000002}",`
#"{00000000-0000-0000-0000-000000000103}",`
#"{00000000-0000-0000-0000-000000000104}",`
#"{00000000-0000-0000-0000-000000000001}",`
#"{00000000-0000-0000-0000-000000000102}",`
#"{00000000-0000-0000-0000-000000000031}",`
#"{00000000-0000-0000-0000-000000000108}",`
#"{00000000-0000-0000-0000-000000000041}",`
#"{00000000-0000-0000-0000-000000000106}",`
#"{00000000-0000-0000-0000-000000000107}")
#
# FOREACH ($REMOTEMACHINE IN GET-CONTENT "C:\TEMP\FILENAME.TXT")
# {
# INVOKE-WMIMETHOD -COMPUTERNAME $REMOTEMACHINE -NAMESPACE ROOT\CCM -CLASS SMS_CLIENT -NAME TRIGGERSCHEDULE $TRIGGER
# }
#==========================================================================================================================


#==============================================================================================================================
# FULL TRIGGER CODE LIST:
#==============================================================================================================================
# {00000000-0000-0000-0000-000000000001} HARDWARE INVENTORY
# {00000000-0000-0000-0000-000000000002} SOFTWARE INVENTORY 
# {00000000-0000-0000-0000-000000000003} DISCOVERY INVENTORY 
# {00000000-0000-0000-0000-000000000010} FILE COLLECTION 
# {00000000-0000-0000-0000-000000000011} IDMIF COLLECTION 
# {00000000-0000-0000-0000-000000000012} CLIENT MACHINE AUTHENTICATION 
# {00000000-0000-0000-0000-000000000021} REQUEST MACHINE ASSIGNMENTS 
# {00000000-0000-0000-0000-000000000022} EVALUATE MACHINE POLICIES 
# {00000000-0000-0000-0000-000000000023} REFRESH DEFAULT MP TASK 
# {00000000-0000-0000-0000-000000000024} LS (LOCATION SERVICE) REFRESH LOCATIONS TASK 
# {00000000-0000-0000-0000-000000000025} LS (LOCATION SERVICE) TIMEOUT REFRESH TASK 
# {00000000-0000-0000-0000-000000000026} POLICY AGENT REQUEST ASSIGNMENT (USER) 
# {00000000-0000-0000-0000-000000000027} POLICY AGENT EVALUATE ASSIGNMENT (USER) 
# {00000000-0000-0000-0000-000000000031} SOFTWARE METERING GENERATING USAGE REPORT 
# {00000000-0000-0000-0000-000000000032} SOURCE UPDATE MESSAGE
# {00000000-0000-0000-0000-000000000037} CLEARING PROXY SETTINGS CACHE 
# {00000000-0000-0000-0000-000000000040} MACHINE POLICY AGENT CLEANUP 
# {00000000-0000-0000-0000-000000000041} USER POLICY AGENT CLEANUP
# {00000000-0000-0000-0000-000000000042} POLICY AGENT VALIDATE MACHINE POLICY / ASSIGNMENT 
# {00000000-0000-0000-0000-000000000043} POLICY AGENT VALIDATE USER POLICY / ASSIGNMENT 
# {00000000-0000-0000-0000-000000000051} RETRYING/REFRESHING CERTIFICATES IN AD ON MP 
# {00000000-0000-0000-0000-000000000061} PEER DP STATUS REPORTING 
# {00000000-0000-0000-0000-000000000062} PEER DP PENDING PACKAGE CHECK SCHEDULE 
# {00000000-0000-0000-0000-000000000063} SUM UPDATES INSTALL SCHEDULE 
# {00000000-0000-0000-0000-000000000071} NAP ACTION 
# {00000000-0000-0000-0000-000000000101} HARDWARE INVENTORY COLLECTION CYCLE 
# {00000000-0000-0000-0000-000000000102} SOFTWARE INVENTORY COLLECTION CYCLE 
# {00000000-0000-0000-0000-000000000103} DISCOVERY DATA COLLECTION CYCLE 
# {00000000-0000-0000-0000-000000000104} FILE COLLECTION CYCLE 
# {00000000-0000-0000-0000-000000000105} IDMIF COLLECTION CYCLE 
# {00000000-0000-0000-0000-000000000106} SOFTWARE METERING USAGE REPORT CYCLE 
# {00000000-0000-0000-0000-000000000107} WINDOWS INSTALLER SOURCE LIST UPDATE CYCLE 
# {00000000-0000-0000-0000-000000000108} SOFTWARE UPDATES ASSIGNMENTS EVALUATION CYCLE 
# {00000000-0000-0000-0000-000000000109} BRANCH DISTRIBUTION POINT MAINTENANCE TASK 
# {00000000-0000-0000-0000-000000000110} DCM POLICY 
# {00000000-0000-0000-0000-000000000111} SEND UNSENT STATE MESSAGE 
# {00000000-0000-0000-0000-000000000112} STATE SYSTEM POLICY CACHE CLEANOUT 
# {00000000-0000-0000-0000-000000000113} SCAN BY UPDATE SOURCE 
# {00000000-0000-0000-0000-000000000114} UPDATE STORE POLICY 
# {00000000-0000-0000-0000-000000000115} STATE SYSTEM POLICY BULK SEND HIGH
# {00000000-0000-0000-0000-000000000116} STATE SYSTEM POLICY BULK SEND LOW 
# {00000000-0000-0000-0000-000000000120} AMT STATUS CHECK POLICY 
# {00000000-0000-0000-0000-000000000121} APPLICATION MANAGER POLICY ACTION 
# {00000000-0000-0000-0000-000000000122} APPLICATION MANAGER USER POLICY ACTION
# {00000000-0000-0000-0000-000000000123} APPLICATION MANAGER GLOBAL EVALUATION ACTION 
# {00000000-0000-0000-0000-000000000131} POWER MANAGEMENT START SUMMARIZER
# {00000000-0000-0000-0000-000000000221} ENDPOINT DEPLOYMENT REEVALUATE 
# {00000000-0000-0000-0000-000000000222} ENDPOINT AM POLICY REEVALUATE 
# {00000000-0000-0000-0000-000000000223} EXTERNAL EVENT DETECTION
